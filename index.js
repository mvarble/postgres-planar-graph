(()=>{"use strict";var e={d:(r,t)=>{for(var n in t)e.o(t,n)&&!e.o(r,n)&&Object.defineProperty(r,n,{enumerable:!0,get:t[n]})},o:(e,r)=>Object.prototype.hasOwnProperty.call(e,r),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},r={};function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,r){if(e){if("string"==typeof e)return o(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?o(e,r):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function i(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function d(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?i(Object(t),!0).forEach((function(r){a(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function a(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}e.r(r),e.d(r,{mapIds:()=>c,dbNodeValues:()=>s,dbEdgeValues:()=>m,dbNodeToValueArray:()=>g,dbNodeToDummyValue:()=>l,dbEdgeToValueArray:()=>f,dbEdgeToDummyValue:()=>p,createRequest:()=>b,isLocation:()=>y,sameLocation:()=>N,isNode:()=>I,sameNode:()=>v,isEdge:()=>h,sameEdge:()=>E,edgeResolves:()=>A,isGraph:()=>O,isDBNode:()=>T,isDBEdge:()=>j,edgeDBResolves:()=>S,isDBGraph:()=>D,isPOSTRequest:()=>R,default:()=>u});const u={mapIds:c,dbNodeValues:s,dbEdgeValues:m,dbNodeToValueArray:g,dbNodeToDummyValue:l,dbEdgeToValueArray:f,dbEdgeToDummyValue:p,createRequest:b,isLocation:y,sameLocation:N,isNode:I,sameNode:v,isEdge:h,sameEdge:E,edgeResolves:A,isGraph:O,isDBNode:T,isDBEdge:j,edgeDBResolves:S,isDBGraph:D,isPOSTRequest:R};function c(e,r){var t=r.reduce((function(r,t,n){return d(d({},r),{},a({},e.createNodes[n].tempId,t.id))}),{});return Object.keys(e).reduce((function(r,n){return"createNodes"===n?r:["createEdges","updateEdges"].includes(n)?d(d({},r),{},a({},n,e[n].map((function(e){return d(d({},e),{},{head:Number.isInteger(e.head)?e.head:t[e.tempHead],tail:Number.isInteger(e.tail)?e.tail:t[e.tempTail]})})))):d(d({},r),{},a({},n,e[n]))}),{})}function s(e){return"INSERT"===e?"(graph, x, y)":"(id, graph, x, y)"}function g(e){var r=!Number.isInteger(e.id),t=Array.isArray(e.location)?e.location[0]:null,n=Array.isArray(e.location)?e.location[1]:null;return r?[e.graph,t,n]:[e.id,e.graph,t,n]}function l(e,r){var t=!Number.isInteger(e.id),n=t?3*r:4*r,o=t?0:1,i=t?"(":"($".concat(n+1,"::INTEGER, ");return Array.isArray(e.location)?"".concat(i,"$").concat(n+o+1,"::INTEGER, $").concat(n+o+2,"::FLOAT, $").concat(n+o+3,"::FLOAT)"):"".concat(i,"$").concat(n+o+1,"::INTEGER, $").concat(n+o+2,"::NULL, $").concat(n+o+3,"::NULL)")}function m(e){return"INSERT"===e?"(graph, head, tail, index)":"(id, graph, head, tail, index)"}function f(e){var r=!Number.isInteger(e.id),t=Number.isInteger(e.index)?e.index:null;return r?[e.graph,e.head,e.tail,t]:[e.id,e.graph,e.head,e.tail,t]}function p(e,r){var t=!Number.isInteger(e.id),n=t?4*r:5*r,o=t?0:1,i=t?"(":"($".concat(n+1,"::INTEGER, "),d="INTEGER";return Number.isInteger(e.index)?"".concat(i,"$").concat(n+o+1,"::").concat(d,", $").concat(n+o+2,"::").concat(d,", $").concat(n+o+3,"::").concat(d,", $").concat(n+o+4,"::").concat(d,")"):"".concat(i,"$").concat(n+o+1,"::").concat(d,", $").concat(n+o+2,"::").concat(d,", $").concat(n+o+3,"::").concat(d,", $").concat(n+o+4,"::NULL)")}function b(e,r,t){if(!D(e)||!O(r)||e.id!==r.id||t&&!Number.isFinite(t))throw new TypeError("".concat("postgres-planar-graph",": see README for 'createRequest signature"));var o={createNodes:[],updateNodes:[],deleteNodes:[],createEdges:[],updateEdges:[],deleteEdges:[]};return o=r.nodes.reduce((function(r,o){if(void 0===o.id)return d(d({},r),{},{createNodes:[].concat(n(r.createNodes),[o])});var i=e.nodes.find((function(e){return e.id===o.id}));return i?v(o,i,t)?r:d(d({},r),{},{updateNodes:[].concat(n(r.updateNodes),[o])}):r}),o),o=e.nodes.reduce((function(e,t){return r.nodes.some((function(e){return e.id===t.id}))?e:d(d({},e),{},{deleteNodes:[].concat(n(e.deleteNodes),[t.id])})}),o),o=r.edges.reduce((function(r,t){if(void 0===t.id)return d(d({},r),{},{createEdges:[].concat(n(r.createEdges),[t])});var o=e.edges.find((function(e){return e.id===t.id}));return o?E(t,o)?r:d(d({},r),{},{updateEdges:[].concat(n(r.updateEdges),[t])}):r}),o),e.edges.reduce((function(e,t){return r.edges.some((function(e){return e.id===t.id}))?e:d(d({},e),{},{deleteEdges:[].concat(n(e.deleteEdges),[t.id])})}),o)}function y(e){return Array.isArray(e)&&2===e.length&&e.every(Number.isFinite)}function N(e,r,t){return void 0===t&&(t=1e-5),!e&&!r||e&&r&&[0,1].every((function(n){return Math.abs(e[n]-r[n])<t}))}function I(e){return"object"===t(e)&&Number.isInteger(e.graph)&&(Number.isInteger(e.id)?void 0===e.tempId:Number.isInteger(e.tempId))&&(!e.location||y(e.location))}function v(e,r,t){return["id","tempId","graph"].every((function(t){return e[t]===r[t]}))&&N(e.location,r.location,t)||!1}function h(e){return"object"===t(e)&&Number.isInteger(e.graph)&&(Number.isInteger(e.head)?void 0===e.tempHead:Number.isInteger(e.tempHead))&&(Number.isInteger(e.tail)?void 0===e.tempTail:Number.isInteger(e.tempTail))&&(void 0===e.index||Number.isInteger(e.index))}function E(e,r){return["id","graph","head","tail","tempHead","tempTail","index"].every((function(t){return e[t]===r[t]}))}function A(e,r){return 2==r.reduce((function(r,t){return function(e,r){return Number.isInteger(e.id)&&e.id===r.head||Number.isInteger(e.tempId)&&e.tempId===r.tempHead}(t,e)||function(e,r){return Number.isInteger(e.id)&&e.id===r.tail||Number.isInteger(e.tempId)&&e.tempId===r.tempTail}(t,e)?r+1:r}),0)}function O(e){return"object"===t(e)&&Number.isInteger(e.id)&&Array.isArray(e.nodes)&&e.nodes.every((function(r){return I(r)&&r.graph===e.id}))&&Array.isArray(e.edges)&&e.edges.every((function(r){return h(r)&&r.graph===e.id&&A(r,e.nodes)}))}function T(e){return"object"===t(e)&&Number.isInteger(e.graph)&&Number.isInteger(e.id)&&void 0===e.tempId&&(!e.location||y(e.location))}function j(e){return"object"===t(e)&&Number.isInteger(e.id)&&Number.isInteger(e.graph)&&Number.isInteger(e.head)&&void 0===e.tempHead&&Number.isInteger(e.tail)&&void 0===e.tempTail&&(void 0===e.index||Number.isInteger(e.index))}function S(e,r){return 2==r.reduce((function(r,t){return function(e,r){return Number.isInteger(e.id)&&e.id===r.head}(t,e)||function(e,r){return Number.isInteger(e.id)&&e.id===r.tail}(t,e)?r+1:r}),0)}function D(e){return"object"===t(e)&&Number.isInteger(e.id)&&Array.isArray(e.nodes)&&e.nodes.every((function(r){return T(r)&&r.graph===e.id}))&&Array.isArray(e.edges)&&e.edges.every((function(r){return j(r)&&r.graph===e.id&&S(r,e.nodes)}))}function R(e){var r=["create","update","delete"].reduce((function(e,r){return[].concat(n(e),["".concat(r,"Nodes"),"".concat(r,"Edges")])}),[]);return"object"===t(e)&&r.every((function(r){return!e[r]||Array.isArray(e[r])}))&&(!e.createNodes||e.createNodes.every((function(e){return I(e)&&void 0===e.id})))&&(!e.updateNodes||e.updateNodes.every(T))&&(!e.deleteNodes||e.deleteNodes.every(Number.isInteger))&&(!e.createEdges||e.createEdges.every(h))&&(!e.updateEdges||e.updateEdges.every((function(e){return h(e)&&Number.isInteger(e.id)})))&&(!e.deleteEdges||e.deleteEdges.every(Number.isInteger))}module.exports=r})();